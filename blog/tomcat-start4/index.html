<!DOCTYPE html><html lang="zh-cn"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> Tomcat启动之Connector启动 · Jemoii's Blog</title><meta name="description" content="Tomcat启动之Connector启动 - Jemoii"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="https://g.hijkl.mn/atom.xml" title="Jemoii's Blog"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="https://github.com/jemoii" target="_blank" class="nav-list-link">GITHUB</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">Tomcat启动之Connector启动</h1><div class="post-info">2017年8月31日</div><div class="post-content"><ul>
<li><a href="/blog/tomcat-start0">Tomcat启动之从脚本说起</a></li>
<li><a href="/blog/tomcat-start1">Tomcat启动之initInternal</a></li>
<li><a href="/blog/tomcat-start2">Tomcat启动之startInternal</a></li>
<li><a href="/blog/tomcat-start3">Tomcat启动之Context启动</a></li>
<li>Tomcat启动之Connector启动</li>
</ul>
<p><em>TODO 进一步整理</em></p>
<p>Connector中的startInternal调用ProtocolHandler#start，接着AbstractEndpoint#start会调用NioEndpoint#startInternal。初始化了<code>http-nio-8080-exec-*</code>线程池，corePoolSize为10，maximumPoolSize为200。初始化了连接计数器，最大连接数为10000。启动Poller线程<code>http-nio-8080-ClientPoller-*</code>。启动Acceptor线程<code>http-nio-8080-Acceptor-*</code>。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div></pre></td><td class="code"><pre><div class="line">   <span class="comment">/**</span></div><div class="line"><span class="comment">    * Start the NIO endpoint, creating acceptor, poller threads.</span></div><div class="line"><span class="comment">    */</span></div><div class="line">   <span class="meta">@Override</span></div><div class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">startInternal</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line"></div><div class="line">       <span class="keyword">if</span> (!running) &#123;</div><div class="line">           running = <span class="keyword">true</span>;</div><div class="line">           paused = <span class="keyword">false</span>;</div><div class="line"></div><div class="line">		...</div><div class="line"></div><div class="line">           <span class="comment">// Create worker collection</span></div><div class="line">           <span class="keyword">if</span> ( getExecutor() == <span class="keyword">null</span> ) &#123;</div><div class="line">               createExecutor();</div><div class="line">           &#125;</div><div class="line"></div><div class="line">           initializeConnectionLatch();</div><div class="line"></div><div class="line">           <span class="comment">// Start poller threads</span></div><div class="line">           pollers = <span class="keyword">new</span> Poller[getPollerThreadCount()];</div><div class="line">           <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;pollers.length; i++) &#123;</div><div class="line">               pollers[i] = <span class="keyword">new</span> Poller();</div><div class="line">               Thread pollerThread = <span class="keyword">new</span> Thread(pollers[i], getName() + <span class="string">"-ClientPoller-"</span>+i);</div><div class="line">               pollerThread.setPriority(threadPriority);</div><div class="line">               pollerThread.setDaemon(<span class="keyword">true</span>);</div><div class="line">               pollerThread.start();</div><div class="line">           &#125;</div><div class="line"></div><div class="line">           startAcceptorThreads();</div><div class="line">       &#125;</div><div class="line">   &#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">createExecutor</span><span class="params">()</span> </span>&#123;</div><div class="line">       internalExecutor = <span class="keyword">true</span>;</div><div class="line">       TaskQueue taskqueue = <span class="keyword">new</span> TaskQueue();</div><div class="line">       TaskThreadFactory tf = <span class="keyword">new</span> TaskThreadFactory(getName() + <span class="string">"-exec-"</span>, daemon, getThreadPriority());</div><div class="line">       executor = <span class="keyword">new</span> ThreadPoolExecutor(getMinSpareThreads(), getMaxThreads(), <span class="number">60</span>, TimeUnit.SECONDS,taskqueue, tf);</div><div class="line">       taskqueue.setParent( (ThreadPoolExecutor) executor);</div><div class="line">   &#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">protected</span> LimitLatch <span class="title">initializeConnectionLatch</span><span class="params">()</span> </span>&#123;</div><div class="line">       <span class="keyword">if</span> (maxConnections==-<span class="number">1</span>) <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">       <span class="keyword">if</span> (connectionLimitLatch==<span class="keyword">null</span>) &#123;</div><div class="line">           connectionLimitLatch = <span class="keyword">new</span> LimitLatch(getMaxConnections());</div><div class="line">       &#125;</div><div class="line">       <span class="keyword">return</span> connectionLimitLatch;</div><div class="line">   &#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">startAcceptorThreads</span><span class="params">()</span> </span>&#123;</div><div class="line">       <span class="keyword">int</span> count = getAcceptorThreadCount();</div><div class="line">       acceptors = <span class="keyword">new</span> Acceptor[count];</div><div class="line"></div><div class="line">       <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; count; i++) &#123;</div><div class="line">           acceptors[i] = createAcceptor();</div><div class="line">           String threadName = getName() + <span class="string">"-Acceptor-"</span> + i;</div><div class="line">           acceptors[i].setThreadName(threadName);</div><div class="line">           Thread t = <span class="keyword">new</span> Thread(acceptors[i], threadName);</div><div class="line">           t.setPriority(getAcceptorThreadPriority());</div><div class="line">           t.setDaemon(getDaemon());</div><div class="line">           t.start();</div><div class="line">       &#125;</div><div class="line">   &#125;</div></pre></td></tr></table></figure>
<p>Acceptor接收连接成功后，接下来由Poller处理，</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div></pre></td><td class="code"><pre><div class="line">                   <span class="comment">//if we have reached max connections, wait</span></div><div class="line">                   countUpOrAwaitConnection();</div><div class="line"></div><div class="line">                   SocketChannel socket = <span class="keyword">null</span>;</div><div class="line">                   <span class="keyword">try</span> &#123;</div><div class="line">                       <span class="comment">// Accept the next incoming connection from the server</span></div><div class="line">                       <span class="comment">// socket</span></div><div class="line">                       socket = serverSock.accept();</div><div class="line">                   &#125; <span class="keyword">catch</span> (IOException ioe) &#123;</div><div class="line">                       <span class="comment">//we didn't get a socket</span></div><div class="line">                       countDownConnection();</div><div class="line">                       <span class="comment">// Introduce delay if necessary</span></div><div class="line">                       errorDelay = handleExceptionWithDelay(errorDelay);</div><div class="line">                       <span class="comment">// re-throw</span></div><div class="line">                       <span class="keyword">throw</span> ioe;</div><div class="line">                   &#125;</div><div class="line">                   <span class="comment">// Successful accept, reset the error delay</span></div><div class="line">                   errorDelay = <span class="number">0</span>;</div><div class="line"></div><div class="line">                   <span class="comment">// setSocketOptions() will add channel to the poller</span></div><div class="line">                   <span class="comment">// if successful</span></div><div class="line">                   <span class="keyword">if</span> (running &amp;&amp; !paused) &#123;</div><div class="line">                       <span class="keyword">if</span> (!setSocketOptions(socket)) &#123;</div><div class="line">                           countDownConnection();</div><div class="line">                           closeSocket(socket);</div><div class="line">                       &#125;</div><div class="line">                   &#125; <span class="keyword">else</span> &#123;</div><div class="line">                       countDownConnection();</div><div class="line">                       closeSocket(socket);</div><div class="line">                   &#125;</div><div class="line"></div><div class="line">   <span class="comment">/**</span></div><div class="line"><span class="comment">    * Process the specified connection.</span></div><div class="line"><span class="comment">    */</span></div><div class="line">   <span class="function"><span class="keyword">protected</span> <span class="keyword">boolean</span> <span class="title">setSocketOptions</span><span class="params">(SocketChannel socket)</span> </span>&#123;</div><div class="line">       <span class="comment">// Process the connection</span></div><div class="line">	...</div><div class="line"></div><div class="line">           NioChannel channel = nioChannels.pop();</div><div class="line">           <span class="keyword">if</span> ( channel == <span class="keyword">null</span> ) &#123;</div><div class="line">			...</div><div class="line">                   <span class="comment">// normal tcp setup</span></div><div class="line">                   NioBufferHandler bufhandler = <span class="keyword">new</span> NioBufferHandler(socketProperties.getAppReadBufSize(),</div><div class="line">                                                                      socketProperties.getAppWriteBufSize(),</div><div class="line">                                                                      socketProperties.getDirectBuffer());</div><div class="line"></div><div class="line">                   channel = <span class="keyword">new</span> NioChannel(socket, bufhandler);</div><div class="line">           &#125;</div><div class="line">		...</div><div class="line">           getPoller0().register(channel);</div><div class="line">	...</div><div class="line">   &#125;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment">    * Return an available poller in true round robin fashion</span></div><div class="line"><span class="comment">    */</span></div><div class="line">   <span class="function"><span class="keyword">public</span> Poller <span class="title">getPoller0</span><span class="params">()</span> </span>&#123;</div><div class="line">       <span class="keyword">int</span> idx = Math.abs(pollerRotater.incrementAndGet()) % pollers.length;</div><div class="line">       <span class="keyword">return</span> pollers[idx];</div><div class="line">   &#125;</div></pre></td></tr></table></figure>
<p>由下图可以看出，打开的Channel被包装为PollerEvent，添加到阻塞队列被循环处理，</p>
<p><img src="https://moetu.fastmirror.org/images/2017/09/20/pollerevent_umld811d2323c4c1b37.jpg" alt=""></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line">                   <span class="keyword">if</span> ( !close ) &#123;</div><div class="line">                       <span class="keyword">if</span> (wakeupCounter.getAndSet(-<span class="number">1</span>) &gt; <span class="number">0</span>) &#123;</div><div class="line">                           <span class="comment">//if we are here, means we have other stuff to do</span></div><div class="line">                           <span class="comment">//do a non blocking select</span></div><div class="line">                           keyCount = selector.selectNow();</div><div class="line">                       &#125; <span class="keyword">else</span> &#123;</div><div class="line">                           keyCount = selector.select(selectorTimeout);</div><div class="line">                       &#125;</div><div class="line">                       wakeupCounter.set(<span class="number">0</span>);</div><div class="line">                   &#125;</div><div class="line">	...</div><div class="line"><span class="comment">//either we timed out or we woke up, process events first</span></div><div class="line">               <span class="keyword">if</span> ( keyCount == <span class="number">0</span> ) hasEvents = (hasEvents | events());</div><div class="line"></div><div class="line">               Iterator&lt;SelectionKey&gt; iterator =</div><div class="line">                   keyCount &gt; <span class="number">0</span> ? selector.selectedKeys().iterator() : <span class="keyword">null</span>;</div><div class="line">               <span class="comment">// Walk through the collection of ready keys and dispatch</span></div><div class="line">               <span class="comment">// any active event.</span></div><div class="line">               <span class="keyword">while</span> (iterator != <span class="keyword">null</span> &amp;&amp; iterator.hasNext()) &#123;</div><div class="line">                   SelectionKey sk = iterator.next();</div><div class="line">                   KeyAttachment attachment = (KeyAttachment)sk.attachment();</div><div class="line">                   <span class="comment">// Attachment may be null if another thread has called</span></div><div class="line">                   <span class="comment">// cancelledKey()</span></div><div class="line">                   <span class="keyword">if</span> (attachment == <span class="keyword">null</span>) &#123;</div><div class="line">                       iterator.remove();</div><div class="line">                   &#125; <span class="keyword">else</span> &#123;</div><div class="line">                       attachment.access();</div><div class="line">                       iterator.remove();</div><div class="line">                       processKey(sk, attachment);</div><div class="line">                   &#125;</div><div class="line">               &#125;<span class="comment">//while</span></div></pre></td></tr></table></figure>
<p><img src="https://moetu.fastmirror.org/images/2017/09/20/processor_umldb06e33b554a7439.jpg" alt=""></p>
<p>接着一步一步来到org.apache.catalina.connector.CoyoteAdapter#service(org.apache.coyote.Request, org.apache.coyote.Response)，所有的容器组件在实例化时，都关联了一个默认的Value，</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">  <span class="comment">/**</span></div><div class="line"><span class="comment">   * Create a new StandardEngine component with the default basic Valve.</span></div><div class="line"><span class="comment">   */</span></div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="title">StandardEngine</span><span class="params">()</span> </span>&#123;</div><div class="line"></div><div class="line">      <span class="keyword">super</span>();</div><div class="line">      pipeline.setBasic(<span class="keyword">new</span> StandardEngineValve());</div><div class="line">...</div><div class="line"></div><div class="line">  &#125;</div></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div></pre></td><td class="code"><pre><div class="line">   <span class="comment">/**</span></div><div class="line"><span class="comment">    * Service method.</span></div><div class="line"><span class="comment">    */</span></div><div class="line">   <span class="meta">@SuppressWarnings</span>(<span class="string">"deprecation"</span>)</div><div class="line">   <span class="meta">@Override</span></div><div class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">service</span><span class="params">(org.apache.coyote.Request req,</span></span></div><div class="line"><span class="function"><span class="params">                       org.apache.coyote.Response res)</span></span></div><div class="line"><span class="function">       <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line"></div><div class="line">       Request request = (Request) req.getNote(ADAPTER_NOTES);</div><div class="line">       Response response = (Response) res.getNote(ADAPTER_NOTES);</div><div class="line">	...</div><div class="line">	        <span class="comment">// Calling the container</span></div><div class="line">               connector.getService().getContainer().getPipeline().getFirst().invoke(request, response);</div><div class="line">	...</div><div class="line">&#125;</div><div class="line"></div><div class="line">   <span class="meta">@Override</span></div><div class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">invoke</span><span class="params">(Request request, Response response)</span></span></div><div class="line"><span class="function">       <span class="keyword">throws</span> IOException, ServletException </span>&#123;</div><div class="line"></div><div class="line">       <span class="comment">// Select the Host to be used for this Request</span></div><div class="line">       Host host = request.getHost();</div><div class="line">       ...</div><div class="line"></div><div class="line">       <span class="comment">// Ask this Host to process this request</span></div><div class="line">       host.getPipeline().getFirst().invoke(request, response);</div><div class="line"></div><div class="line">   &#125;</div><div class="line"></div><div class="line">   <span class="meta">@Override</span></div><div class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">invoke</span><span class="params">(Request request, Response response)</span></span></div><div class="line"><span class="function">       <span class="keyword">throws</span> IOException, ServletException </span>&#123;</div><div class="line"></div><div class="line">       <span class="comment">// Select the Context to be used for this Request</span></div><div class="line">       Context context = request.getContext();</div><div class="line">	...</div><div class="line">                   context.getPipeline().getFirst().invoke(request, response);</div><div class="line">	...</div><div class="line">&#125;</div><div class="line"></div><div class="line">   <span class="meta">@Override</span></div><div class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">invoke</span><span class="params">(Request request, Response response)</span></span></div><div class="line"><span class="function">       <span class="keyword">throws</span> IOException, ServletException </span>&#123;</div><div class="line"></div><div class="line">       ...</div><div class="line"></div><div class="line">       <span class="comment">// Select the Wrapper to be used for this Request</span></div><div class="line">       Wrapper wrapper = request.getWrapper();</div><div class="line">	...</div><div class="line">       wrapper.getPipeline().getFirst().invoke(request, response);</div><div class="line">   &#125;</div><div class="line"></div><div class="line">   <span class="meta">@Override</span></div><div class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">invoke</span><span class="params">(Request request, Response response)</span></span></div><div class="line"><span class="function">       <span class="keyword">throws</span> IOException, ServletException </span>&#123;</div><div class="line"></div><div class="line">       <span class="comment">// Initialize local variables we may need</span></div><div class="line">       <span class="keyword">boolean</span> unavailable = <span class="keyword">false</span>;</div><div class="line">       Throwable throwable = <span class="keyword">null</span>;</div><div class="line">       <span class="comment">// This should be a Request attribute...</span></div><div class="line">       <span class="keyword">long</span> t1=System.currentTimeMillis();</div><div class="line">       requestCount.incrementAndGet();</div><div class="line">       StandardWrapper wrapper = (StandardWrapper) getContainer();</div><div class="line">       Servlet servlet = <span class="keyword">null</span>;</div><div class="line">       Context context = (Context) wrapper.getParent();</div><div class="line"></div><div class="line">       ...</div><div class="line"></div><div class="line">       <span class="comment">// Allocate a servlet instance to process this request</span></div><div class="line"></div><div class="line">           <span class="keyword">if</span> (!unavailable) &#123;</div><div class="line">               servlet = wrapper.allocate();</div><div class="line">           &#125;</div><div class="line">       ...</div><div class="line">       <span class="comment">// Create the filter chain for this request</span></div><div class="line">       ApplicationFilterChain filterChain =</div><div class="line">               ApplicationFilterFactory.createFilterChain(request, wrapper, servlet);</div><div class="line"></div><div class="line">       <span class="comment">// Call the filter chain for this request</span></div><div class="line">       <span class="comment">// <span class="doctag">NOTE:</span> This also calls the servlet's service() method</span></div><div class="line">	...</div><div class="line">                       filterChain.doFilter</div><div class="line">                           (request.getRequest(), response.getResponse());</div><div class="line">       ...</div><div class="line"></div><div class="line">   &#125;</div></pre></td></tr></table></figure></div></article></div></main><footer><div class="paginator"><a href="/blog/tomcat-start3/" class="next">下一篇</a></div><div class="copyright"><p>© 2014 - 2017 <a href="https://g.hijkl.mn">Jemoii</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>