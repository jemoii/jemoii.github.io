<!DOCTYPE html><html lang="zh-cn"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> Sorting and Counting Rows · Jemoii's Blog</title><meta name="description" content="Sorting and Counting Rows - Jemoii"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="https://g.hijkl.mn/atom.xml" title="Jemoii's Blog"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="https://github.com/jemoii" target="_blank" class="nav-list-link">GITHUB</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">Sorting and Counting Rows</h1><div class="post-info">2014年12月21日</div><div class="post-content"><p>####Sorting Rows</p>
<p>你可能注意到,前面的例子中,结果行的排列没有特定的顺序,当行按一定有意义的方法排序时,更容易去检查查询结果.使用<code>ORDER BY</code>来排序一个结果.</p>
<p>这是鸟儿的生日按日期排序:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">mysql&gt; SELECT name, birth FROM pet ORDER BY birth;</div><div class="line">+----------+------------+</div><div class="line">| name     | birth      |</div><div class="line">+----------+------------+</div><div class="line">| Buffy    | 1989-05-13 |</div><div class="line">| Bowser   | 1989-08-31 |</div><div class="line">| Fang     | 1990-08-27 |</div><div class="line">| Fluffy   | 1993-02-04 |</div><div class="line">| Claws    | 1994-03-17 |</div><div class="line">| Slim     | 1996-04-29 |</div><div class="line">| Whistler | 1997-12-09 |</div><div class="line">| Chirpy   | 1998-09-11 |</div><div class="line">| Puffball | 1999-03-30 |</div><div class="line">+----------+------------+</div></pre></td></tr></table></figure>
<p>在字符类型的列中,排序和其他比较操作一样,正常情况下对大小写不敏感,这意味着,列的顺序除了大小写外是唯一的,你可以使用<code>BINARY</code>来强制排序对大小写敏感,像这样:<code>ORDER BY BINARY col_name</code></p>
<p>默认情况下,排序按升序排列,给被排列的列名添加关键字<code>DESC</code>可以使其按降序排列:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">mysql&gt; SELECT name, birth FROM pet ORDER BY birth DESC;</div><div class="line">+----------+------------+</div><div class="line">| name     | birth      |</div><div class="line">+----------+------------+</div><div class="line">| Puffball | 1999-03-30 |</div><div class="line">| Chirpy   | 1998-09-11 |</div><div class="line">| Whistler | 1997-12-09 |</div><div class="line">| Slim     | 1996-04-29 |</div><div class="line">| Claws    | 1994-03-17 |</div><div class="line">| Fluffy   | 1993-02-04 |</div><div class="line">| Fang     | 1990-08-27 |</div><div class="line">| Bowser   | 1989-08-31 |</div><div class="line">| Buffy    | 1989-05-13 |</div><div class="line">+----------+------------+</div></pre></td></tr></table></figure>
<p>你可以排序多个列,对不同的列实行不同的排序方法,例如,先按宠物类型的升序排序,再按宠物出生日期的降序排序,使用下面的查询:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">mysql&gt; SELECT name, species, birth FROM pet</div><div class="line">    -&gt; ORDER BY species, birth DESC;</div><div class="line">+----------+---------+------------+</div><div class="line">| name     | species | birth      |</div><div class="line">+----------+---------+------------+</div><div class="line">| Chirpy   | bird    | 1998-09-11 |</div><div class="line">| Whistler | bird    | 1997-12-09 |</div><div class="line">| Claws    | cat     | 1994-03-17 |</div><div class="line">| Fluffy   | cat     | 1993-02-04 |</div><div class="line">| Fang     | dog     | 1990-08-27 |</div><div class="line">| Bowser   | dog     | 1989-08-31 |</div><div class="line">| Buffy    | dog     | 1989-05-13 |</div><div class="line">| Puffball | hamster | 1999-03-30 |</div><div class="line">| Slim     | snake   | 1996-04-29 |</div><div class="line">+----------+---------+------------+</div></pre></td></tr></table></figure>
<p>关键字<code>DESC</code>只应用于它前面,紧接着它的列名(<code>birth</code>),而不影响其他列(<code>species</code>)的排序.</p>
<p>####Counting Rows</p>
<p>数据库经常用来回答这样的问题,一个表中某种类型的数据的出现频率.例如,你可能想知道你有多少宠物,每个主人有多少宠物,或者你想实现其他方式的统计.</p>
<p>计算宠物的总数,等价于,<code>pet</code>表有多少行,因为每个宠物只有一条记录.用<code>COUNT(*)</code>统计行的数量,所以像这样统计你的宠物数量:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">mysql&gt; SELECT COUNT(*) FROM pet;</div><div class="line">+----------+</div><div class="line">| COUNT(*) |</div><div class="line">+----------+</div><div class="line">|        9 |</div><div class="line">+----------+</div></pre></td></tr></table></figure>
<p>前面,你检索了拥有宠物的主人的名字,如果你想知道每个主人有多少宠物,你也可以使用<code>COUNT(*)</code>:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">mysql&gt; SELECT owner, COUNT(*) FROM pet GROUP BY owner;</div><div class="line">+--------+----------+</div><div class="line">| owner  | COUNT(*) |</div><div class="line">+--------+----------+</div><div class="line">| Benny  |        2 |</div><div class="line">| Diane  |        2 |</div><div class="line">| Gwen   |        3 |</div><div class="line">| Harold |        2 |</div><div class="line">+--------+----------+</div></pre></td></tr></table></figure>
<p>这个查询使用了<code>GROUP BY</code>为每个<code>owner</code>分组所有的记录,结合使用<code>COUNT(*)</code>和<code>GROUP BY</code>对于描述不同分组下的数据是很有用的,下面的例子,展示了其他方式的统计:</p>
<p>每个性别的动物数量:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">mysql&gt; SELECT sex, COUNT(*) FROM pet GROUP BY sex;</div><div class="line">+------+----------+</div><div class="line">| sex  | COUNT(*) |</div><div class="line">+------+----------+</div><div class="line">| NULL |        1 |</div><div class="line">| f    |        4 |</div><div class="line">| m    |        4 |</div><div class="line">+------+----------+</div></pre></td></tr></table></figure>
<p>查询结果中的<code>NULL</code>表明性别未知.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">mysql&gt; SELECT species, sex, COUNT(*) FROM pet GROUP BY species, sex;</div><div class="line">+---------+------+----------+</div><div class="line">| species | sex  | COUNT(*) |</div><div class="line">+---------+------+----------+</div><div class="line">| bird    | NULL |        1 |</div><div class="line">| bird    | f    |        1 |</div><div class="line">| cat     | f    |        1 |</div><div class="line">| cat     | m    |        1 |</div><div class="line">| dog     | f    |        1 |</div><div class="line">| dog     | m    |        2 |</div><div class="line">| hamster | f    |        1 |</div><div class="line">| snake   | m    |        1 |</div><div class="line">+---------+------+----------+</div></pre></td></tr></table></figure>
<p>当你使用<code>COUNT(*)</code>时,也不需要检索整个表,例如,当你仅仅统计<code>dog</code>,<code>cat</code>时:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">mysql&gt; SELECT species, sex, COUNT(*) FROM pet</div><div class="line">    -&gt; WHERE species = &apos;dog&apos; OR species = &apos;cat&apos;</div><div class="line">    -&gt; GROUP BY species, sex;</div><div class="line">+---------+------+----------+</div><div class="line">| species | sex  | COUNT(*) |</div><div class="line">+---------+------+----------+</div><div class="line">| cat     | f    |        1 |</div><div class="line">| cat     | m    |        1 |</div><div class="line">| dog     | f    |        1 |</div><div class="line">| dog     | m    |        2 |</div><div class="line">+---------+------+----------+</div></pre></td></tr></table></figure>
<p>####英文原文：</p>
<p><a href="http://dev.mysql.com/doc/refman/5.6/en/sorting-rows.html" target="_blank" rel="external">Sorting Rows</a></p>
<p><a href="http://dev.mysql.com/doc/refman/5.6/en/counting-rows.html" target="_blank" rel="external">Counting Rows</a></p>
</div></article></div></main><footer><div class="paginator"><a href="/multiple-tables/" class="prev">上一篇</a><a href="/pattern-matching/" class="next">下一篇</a></div><div class="copyright"><p>© 2014 - 2017 <a href="https://g.hijkl.mn">Jemoii</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>