<!DOCTYPE html><html lang="zh-cn"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> 使用Git协同工作 · Jemoii's Blog</title><meta name="description" content="使用Git协同工作 - Jemoii"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="https://g.hijkl.mn/atom.xml" title="Jemoii's Blog"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="https://github.com/jemoii" target="_blank" class="nav-list-link">GITHUB</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">使用Git协同工作</h1><div class="post-info">2016年2月18日</div><div class="post-content"><p>本文没有深层次的分析<strong>Git</strong>的工作原理，而是从实用角度，关注常用命令，简单分析了执行命令时发生的具体动作。</p>
<p>####建立本地仓库</p>
<p>从远端仓库克隆数据到本地仓库</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git clone https://github.com/jemoii/Koenigspress.git Koenigspress</div></pre></td></tr></table></figure>
<p>执行<code>git clone</code>命令，默认将远端仓库命名为<code>origin</code>，</p>
<ul>
<li>拉取远端仓库的所有数据；</li>
<li>创建一个指向远端仓库<code>master</code>分支的指针，并在本地将其命名为<code>origin/master</code>；</li>
<li>创建一个跟踪<code>origin/master</code>的本地<code>master</code>分支。</li>
</ul>
<p>添加<code>-o away</code>选项，即执行</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git clone -o away https://github.com/jemoii/Koenigspress.git Koenigspress</div></pre></td></tr></table></figure>
<p>远端仓库被命名为<code>away</code>，相应的本地指向远端仓库<code>master</code>分支的指针被命名为<code>away/master</code></p>
<p>回到上一步，可以通过<code>git remote show origin</code>查看远端仓库的相关信息，这里的<code>origin</code>即远端仓库</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">$ git remote</div><div class="line">origin</div><div class="line"></div><div class="line">$ git remote show origin</div><div class="line">* remote origin</div><div class="line">  Fetch URL: https://github.com/jemoii/Koenigspress.git</div><div class="line">  Push  URL: https://github.com/jemoii/Koenigspress.git</div><div class="line">  HEAD branch: master</div><div class="line">  Remote branch:</div><div class="line">    master tracked</div><div class="line">  Local branch configured for &apos;git pull&apos;:</div><div class="line">    master merges with remote master</div><div class="line">  Local ref configured for &apos;git push&apos;:</div><div class="line">    master pushes to master (up to date)</div></pre></td></tr></table></figure>
<p>####管理本地分支</p>
<p>现在执行<code>git branch optimize_theme</code>在<code>master</code>上新建<code>optimize_theme</code>分支，执行<code>git checkout optimize_theme</code>切换到<code>optimize_theme</code>分支上。</p>
<p>可以使用<code>git checkout -b optimize_theme</code>合并上述两步操作，执行<code>git branch</code>显示本地仓库分支列表，<code>*</code>标识当前位于<code>optimize_theme</code>分支</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$ git checkout -b optimize_theme</div><div class="line">Switched to a new branch &apos;optimize_theme&apos;</div><div class="line"></div><div class="line">$ git branch</div><div class="line">  master</div><div class="line">* optimize_theme</div></pre></td></tr></table></figure>
<p>####提交更新</p>
<p>修改文件后，执行<code>git add .</code>将修改内容添加到<code>暂存区</code>，接着执行<code>git commit -m &#39;提交主题优化&#39;</code>将修改内容提交到<code>本地仓库</code>。</p>
<p>可以使用<code>git commit -a -m &#39;提交主题优化&#39;</code>合并上述两步操作。</p>
<p>现在使用<code>git push origin optimize_theme</code>将修改内容推送到远端仓库，远端仓库新建分支<code>optimize</code>保存修改内容</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$ git push origin optimize_theme</div><div class="line">Username for &apos;https://github.com&apos;: jemoii</div><div class="line">Password for &apos;https://jemoii@github.com&apos;:</div><div class="line">Total 0 (delta 0), reused 0 (delta 0)</div><div class="line">To https://github.com/jemoii/Koenigspress.git</div><div class="line"> * [new branch]      optimize_theme -&gt; optimize_theme</div></pre></td></tr></table></figure>
<p>现在执行<code>git remote show origin</code>查看远端仓库信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">$ git remote show origin</div><div class="line">* remote origin</div><div class="line">  Fetch URL: https://github.com/jemoii/Koenigspress.git</div><div class="line">  Push  URL: https://github.com/jemoii/Koenigspress.git</div><div class="line">  HEAD branch: master</div><div class="line">  Remote branches:</div><div class="line">    master         tracked</div><div class="line">    optimize_theme tracked</div><div class="line">  Local branch configured for &apos;git pull&apos;:</div><div class="line">    master merges with remote master</div><div class="line">  Local refs configured for &apos;git push&apos;:</div><div class="line">    master         pushes to master         (up to date)</div><div class="line">    optimize_theme pushes to optimize_theme (up to date)</div></pre></td></tr></table></figure>
<p>可以看到除了<code>master</code>分支，现在本地分支<code>optimize_theme</code>跟踪<code>origin/optimize_theme</code>。</p>
<p>####更新本地仓库</p>
<p>如果有另外一个<code>协同者</code>与我们一样克隆了远端仓库的数据到他的本地仓库，新建<code>fix_bug</code>分支，类似的将修改内容推送到远端仓库，且在我们执行<code>git push</code>前将修改内容合并到远端仓库的<code>master</code>分支，现在远端仓库<code>master</code>分支上的内容与我们执行<code>git clone</code>时相比发生了变化，我们再执行<code>git push</code>时会提示需要先将<code>协同者</code>的修改内容合并到我们的分支上。</p>
<p>首先执行<code>git checkout master</code>切换到<code>master</code>分支，执行<code>git fetch origin</code>，</p>
<ul>
<li>从远端仓库获取本地仓库没有的数据，移动<code>origin/master</code>指针指向更新后的位置；</li>
<li>创建一个指向远端仓库<code>fix_bug</code>分支的指针，并在本地将其命名为<code>origin/fix_bug</code>，本地不会新建<code>fix_bug</code>分支，只创建不可编辑的<code>origin/fix_bug</code>指针；</li>
</ul>
<p>现在执行<code>git merge origin/master</code>将更新的数据合并到本地仓库的<code>master</code>分支，接着执行<code>git checkout optimize_theme</code>重新切换到<code>optimize_theme</code>分支，执行<code>git merge master</code>将更新的数据合并到本地仓库的<code>optimize_theme</code>分支。</p>
<p>现在执行<code>git push origin optimize_theme</code>可以将我们的修改内容推送到远端仓库。</p>
<p>回到上一步，在<code>master</code>分支上使用<code>git pull</code>可以合并<code>git fetch origin</code>、<code>git merge origin/master</code>两步操作。</p>
<p><em>关于<code>git merge</code></em></p>
<p>####附</p>
<p>协同开发中创建工作分支的两种方式，第一种是前面提到的在本地仓库新建工作分支，执行<code>git push</code>时在远端仓库创建对应的工作分支；另一种是在远端仓库新建工作分支，执行<code>新建/更新</code>时在本地仓库创建指向远端仓库工作分支的指针，接着执行类似如下的命令，</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git checkout -b fix_bug origin/fix_bug</div></pre></td></tr></table></figure>
<p>在本地仓库创建<code>fix_bug</code>分支，跟踪<code>origin/fix_bug</code>，执行结束后切换到<code>fix_bug</code>分支。</p>
</div></article></div></main><footer><div class="paginator"><a href="/explanation-for-hashtable-and-hashmap/" class="prev">上一篇</a><a href="/cas-server/" class="next">下一篇</a></div><div class="copyright"><p>© 2014 - 2017 <a href="https://g.hijkl.mn">Jemoii</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>